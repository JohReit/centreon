server {

    listen *:80 default_server;
    server_name _;
    root /usr/share/centreon;

    server_tokens off;
    add_header X-Frame-Options SAMEORIGIN;
    add_header Set-Cookie "Path=/; HttpOnly; Secure";

    location / {
        rewrite ^/$ /centreon/ redirect;
    }

    location ~ ^/centreon/?(authentication|api/(latest|betai|v[0-9]+|v[0-9]+\.[0-9]+/))$ {
        alias /usr/share/centreon/api/;
        index index.php index.html;

        location ~ \.php$ {
            include /etc/nginx/snippets/fastcgi-php.conf;
            fastcgi_param SCRIPT_FILENAME $request_filename;
            fastcgi_pass 127.0.0.1:9042;
        }
    }

    location /centreon/ {
        alias /usr/share/centreon/www/;
        index index.php index.html;

        location ~ \.php$ {
            include /etc/nginx/snippets/fastcgi-php.conf;
            fastcgi_param SCRIPT_FILENAME $request_filename;
            fastcgi_pass 127.0.0.1:9042;
        }
    }

}
